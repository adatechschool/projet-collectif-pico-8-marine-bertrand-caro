pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--pico8 projet ada
-- panther's adventure

function _init()
--make player
	create_player()
end

function _update60()
  player_movement()
end

function _draw()
cls()
map(0,0,0,0,128,64)
spr(p.sprite,p.x,p.y)
update_camera()
end

function create_player()
	p = {
		x=8, y=8, --position init
		dx=0, dy=0, --vitesse init
		sprite = 10,
		speed = 1,
		chest = 0,
		w = 5, h = 6 --largeur et hauteur
	}
end

function player_movement()
 newx = p.x
 newy = p.y

	if(btn(⬅️)) newx-=1--p.dx -= p.speed
	if(btn(➡️)) newx+=1--p.dx += p.speed
	if(btn(⬆️)) newy-=1--p.dy -= p.speed
	if(btn(⬇️)) newy+=1--p.dy += p.speed
	
	interact(newx,newy)
	
	if not check_flag(0,newx,newy) then
		p.x=mid(0,newx,127)
		p.y=mid(0,newy,63)
		else
		sfx(0)
		end
	end
	
function interact(x,y)
	if check_flag(1,x,y) then
	get_chest(x,y)
end 
	
if can_move(p.x+p.dx, p.y, p.w, p.h)
	then p.x += p.dx
end

if can_move(p.x, p.y+p.dy, p.w, p.h)
	then p.y += p.dy
end

p.dx, p.dy = 0,0
end

function can_move(x, y, w, h)
	if (check_obstacle(x, y)) return false         -- coin haut-gauche
	if (check_obstacle(x+w-1, y)) return false     -- coin haut-droite
	if (check_obstacle(x, y+h-1)) return false     -- coin bas-gauche
	if (check_obstacle(x+w-1, y+h-1)) return false -- coin bas-droite
	return true
end

function check_obstacle(x,y)
	local map_x = flr(x/8)
	local map_y = flr(y/8)
	local sprite = mget(map_x, map_y)
	return fget(sprite, 0)
end

function update_camera()
	local camx=flr(p.x/128)
	local camy=flr(p.y/128)
	camera(camx*128,camy*96)
end

function next_tile(x,y)
	local sprite=mget(x,y)
	mset(x,y,sprite+1)
end

function get_chest(x,y)
	next_tile(x,y)
	p.chest+=1
	sfx(0)
end
__gfx__
0000000033333333000004040400000033333333aaaaaaaaf999999f666666666666666600000000000000003333333333333333000000000000000000000000
0000000033366333000004040400000033333333aaaaaaaaffffff9f6dddddddddddddd6011111100e0000003999999333333333000000000000000000000000
0070070033666d3300004404044000003b333333aa9aa9aaf9999f9f6d555555555555d6017781100eeeee003945549333333333000000000000000000000000
0007700036655dd3000005555500000033b33b33aaa99aaaf9ff9f9f6d558555555555d60178811000e88e003999999333333333000000000000000000000000
0007700036655dd3000004040400000033b3b333aaa99aaaf9ff9f9f6d555555555555d60188781000e55e00395aa59333333333000000000000000000000000
00700700336ddd33000004040400000033bb3333aa9aa9aaf9f99f9f6d555555555555d60111781000eeee003955559333333333000000000000000000000000
00000000333dd33300000404040000003b3333b3aaaaaaaaf9ffff9f6d555555555555d60111111000e00e003999999333333333000000000000000000000000
0000000033333333000044040440000033333333aaaaaaaaf999999f6d555555555555d600000000000000003333333333333333000000000000000000000000
000000000000000000000555550000000000000000000000000000006d555555555555d600000000000000000000000000000000000000000000000000000000
000000000000000000004404044000000000000000000000000000006d555555555555d600000000000000000000000000000000000000000000000000000000
000000000000000000000404040000000000000000000000000000006d555555555555d600000000000000000000000000000000000000000000000000000000
000000000000000000000404040000000000000000000000000000006d555555558555d600000000000000000000000000000000000000000000000000000000
000000000000000000000555550000000000000000000000000000006d555555555555d600000000000000000000000000000000000000000000000000000000
000000000000000000004404044000000000000000000000000000006d555555555555d600000000000000000000000000000000000000000000000000000000
000000000000000000000404040000000000000000000000000000006dddddddddddddd600000000000000000000000000000000000000000000000000000000
00000000000000000000040404000000000000000000000000000000666666666666666600000000000000000000000000000000000000000000000000000000
__gff__
0001000000000100000100020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101010101010101010101010101010106060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01040404040401040b0404010404040106050505050605050505050505050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040404040104040404010404040106050b05050505050505050605050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040404040104010104010404040106050505060606060505050605050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040404040104010104010404040106050505060505060606050606050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040404040104040404010404040106050505060505050505050605050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040101010104040404040404040106060606060505050505050605050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040404040104040104040404040405050505050505060606060606050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040101040104040104010404040106060606060505060505050506050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040401040101010104010404040106050505050505060505060506050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040401040404040404010404040106050505050505060505060505050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104040401040404040404010404040106050505050505060505060505050600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010106060606060606060505060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009090909090909090505090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009070807080708090708070807080900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009171817181718091718171817180900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009070807080708070708070807080900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009171817181718071718171817180900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009070807080708090708070807080900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009171817181718091718171817180900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009070807080708090708070807080900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000091718170b1718091718171817180900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009181818181818091818181818180900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009090909090909090909090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100003f35009300023000d3000a300083000330001300000000500005000050000500005000050000500006000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001000006000010000c0000b00006000090000e00012000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 40424344

